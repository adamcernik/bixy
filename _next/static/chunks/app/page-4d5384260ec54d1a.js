(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{810:(e,s,r)=>{"use strict";let t,i,n,l;r.d(s,{db:()=>i,hJ:()=>l,j2:()=>n,vE:()=>x});var a=r(3915),o=r(5317),c=r(6864),d=r(6203);try{(0,a.Dk)().length?(t=(0,a.Dk)()[0],console.log("Using existing Firebase app")):(t=(0,a.Wp)({apiKey:"AIzaSyAZ4cdr8KZU-Z5Ohp04MzvIGLG_tGblxfE",authDomain:"bixy-stock.firebaseapp.com",projectId:"bixy-stock",storageBucket:"bixy-stock.appspot.com",messagingSenderId:"357634877813",appId:"1:357634877813:web:80fc5b029a1606c3200b3c",measurementId:"G-3DZEWTG2HW"}),console.log("Firebase initialized successfully")),i=(0,o.aU)(t),console.log("Firestore initialized successfully"),n=(0,d.xI)(t),l=new d.HF,console.log("Firebase Auth initialized successfully")}catch(e){throw console.error("Error initializing Firebase:",e),e}(0,c.P5)(t);let x="adam.cernik@gmail.com"},1396:(e,s,r)=>{"use strict";r.d(s,{BP:()=>a,CF:()=>c,G6:()=>l,JY:()=>d,LU:()=>o});var t=r(6203),i=r(5317),n=r(810);let l=async()=>{try{let e=(await (0,t.df)(n.j2,n.hJ)).user,s=(0,i.H9)(n.db,"users",e.uid),r=await (0,i.x7)(s),l=i.Dc.now(),a=e.email===n.vE;if(r.exists()){let e=r.data();return await (0,i.mZ)(s,{lastLogin:l}),e}{let r={uid:e.uid,email:e.email||"",displayName:e.displayName||"",photoURL:e.photoURL,hasAccess:a,isAdmin:a,lastLogin:l,createdAt:l};return await (0,i.BN)(s,r),r}}catch(e){return console.error("Error signing in with Google:",e),null}},a=async()=>{try{return await (0,t.CI)(n.j2),!0}catch(e){return console.error("Error signing out:",e),!1}},o=async e=>{try{let s=(0,i.H9)(n.db,"users",e.uid),r=await (0,i.x7)(s);if(r.exists())return r.data();return null}catch(e){return console.error("Error getting current user data:",e),null}},c=async()=>{try{let e=(0,i.rJ)(n.db,"users"),s=(0,i.P)(e),r=await (0,i.GG)(s),t=[];return r.forEach(e=>{t.push(e.data())}),t}catch(e){return console.error("Error getting users:",e),[]}},d=async(e,s)=>{try{let r=(0,i.H9)(n.db,"users",e);return await (0,i.mZ)(r,{hasAccess:s}),!0}catch(e){return console.error("Error updating user access:",e),!1}}},1786:(e,s,r)=>{Promise.resolve().then(r.bind(r,9034))},3475:(e,s,r)=>{"use strict";r.d(s,{A:()=>c,AuthProvider:()=>d});var t=r(5155),i=r(2115),n=r(6203),l=r(810),a=r(1396);let o=(0,i.createContext)({user:null,userData:null,loading:!0,loginWithGoogle:async()=>{},logout:async()=>{}});function c(){return(0,i.useContext)(o)}function d(e){let{children:s}=e,[r,c]=(0,i.useState)(null),[d,x]=(0,i.useState)(null),[h,u]=(0,i.useState)(!0);(0,i.useEffect)(()=>(0,n.hg)(l.j2,async e=>{c(e),e?x(await (0,a.LU)(e)):x(null),u(!1)}),[]);let m=async()=>{try{let e=await (0,a.G6)();x(e)}catch(e){console.error("Error logging in with Google:",e)}},g=async()=>{try{await (0,a.BP)(),x(null)}catch(e){console.error("Error logging out:",e)}};return(0,t.jsx)(o.Provider,{value:{user:r,userData:d,loading:h,loginWithGoogle:m,logout:g},children:!h&&s})}},4792:(e,s,r)=>{"use strict";r.d(s,{O:()=>i});let t=()=>{{let e=window.location.hostname.includes("github.io"),s=e?"/bixy":"";return console.debug('[getBasePath] Using base path: "'.concat(s,'" (isGitHubPages: ').concat(e,")")),s}},i=e=>{let s=t(),r=e;r.startsWith("/bixy/")&&(console.debug('[getAssetPath] Removing "/bixy" prefix from path: '.concat(e)),r=r.substring(5)),r.startsWith("/")&&(s.endsWith("/")||""!==s)&&(r=r.substring(1));let i="".concat(s,"/").concat(r).replace(/\/+/g,"/");return console.debug('[getAssetPath] Original: "'.concat(e,'", Clean: "').concat(r,'", Final: "').concat(i,'"')),i}},9034:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>I});var t=r(5155),i=r(2115),n=r(5028),l=r(810),a=r(5317),o=r(3729);function c(){let[e,s]=(0,i.useState)("loading"),[r,n]=(0,i.useState)(null);return(0,i.useEffect)(()=>{(async()=>{try{await (0,a.GG)((0,a.rJ)(l.db,"bikes")),s("connected")}catch(e){console.error("Firebase connection error:",e),s("error"),n(e instanceof Error?e.message:String(e))}})()},[]),(0,t.jsx)(o.A,{title:"loading"===e?"Testing database connection...":"connected"===e?"Connected to database":"Error connecting to database: ".concat(r),arrow:!0,placement:"bottom",children:(0,t.jsx)("div",{className:"\n          w-3 h-3 rounded-full \n          ".concat("loading"===e?"bg-yellow-400 animate-pulse":"connected"===e?"bg-green-500":"bg-red-500","\n        "),style:{cursor:"help"}})})}var d=r(4581),x=r(8534),h=r(700),u=r(6220),m=r(2663),g=r(9710),b=r(6380),f=r(6997),j=r(3475);function p(){var e;let{user:s,userData:r,loginWithGoogle:n,logout:l}=(0,j.A)(),[a,c]=(0,i.useState)(null),p=()=>{c(null)},v=async()=>{await l(),p()};return(0,t.jsx)(d.A,{sx:{display:"flex",alignItems:"center"},children:s?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.A,{title:"Account settings",children:(0,t.jsxs)(d.A,{sx:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:e=>{c(e.currentTarget)},children:[(0,t.jsx)(h.A,{variant:"body1",sx:{mr:1,color:"#fff",display:{xs:"none",sm:"block"}},children:(null==r?void 0:r.displayName)?r.displayName.split(" ")[0]:""}),(0,t.jsx)(u.A,{size:"medium",color:"inherit","aria-controls":"menu-appbar","aria-haspopup":"true",sx:{p:0},children:(null==r?void 0:r.photoURL)?(0,t.jsx)(m.A,{alt:r.displayName,src:r.photoURL,sx:{width:36,height:36,border:"2px solid white"}}):(0,t.jsx)(m.A,{sx:{width:36,height:36,bgcolor:"#1976d2",color:"#fff",border:"2px solid white"},children:(null==r||null==(e=r.displayName)?void 0:e.charAt(0))||"U"})})]})}),(0,t.jsxs)(g.A,{id:"menu-appbar",anchorEl:a,anchorOrigin:{vertical:"bottom",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:!!a,onClose:p,children:[(0,t.jsxs)(b.A,{onClick:p,sx:{color:"#000"},children:["Signed in as: ",null==r?void 0:r.email]}),(0,t.jsx)(b.A,{onClick:v,sx:{color:"#000"},children:"Logout"})]})]}):(0,t.jsx)(x.A,{variant:"outlined",color:"inherit",onClick:n,startIcon:(0,t.jsx)(f.A,{}),sx:{color:"#fff",borderColor:"#fff","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.1)",borderColor:"#fff"}},children:"Sign In"})})}var v=r(8407),y=r(9415);function w(){let{userData:e,logout:s}=(0,j.A)();return(0,t.jsx)(d.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"calc(100vh - 160px)",p:3},children:(0,t.jsxs)(v.A,{elevation:3,sx:{p:4,display:"flex",flexDirection:"column",alignItems:"center",maxWidth:500,width:"100%",borderRadius:2},children:[(0,t.jsx)(m.A,{sx:{m:1,bgcolor:"error.main",width:56,height:56},children:(0,t.jsx)(y.A,{fontSize:"large"})}),(0,t.jsx)(h.A,{variant:"h5",component:"h1",sx:{mb:2,mt:2,fontWeight:"bold"},children:"Access Restricted"}),(0,t.jsxs)(h.A,{variant:"body1",align:"center",sx:{mb:3},children:["Hello ",(0,t.jsx)("strong",{children:(null==e?void 0:e.displayName)||"User"}),",",(0,t.jsx)("br",{}),"Your account needs approval before you can access this inventory system."]}),(0,t.jsx)(h.A,{variant:"body2",align:"center",color:"text.secondary",sx:{mb:3},children:"The administrator has been notified about your registration. Once your access is approved, you will be able to view and manage the inventory."}),(0,t.jsx)(x.A,{variant:"contained",color:"primary",onClick:s,sx:{mt:2},children:"Sign Out"})]})})}var A=r(9994),N=r(5715),k=r(8025),S=r(5695),E=r(4792);let C=(0,n.default)(()=>Promise.all([r.e(524),r.e(405),r.e(410),r.e(639),r.e(267)]).then(r.bind(r,2788)),{loadableGenerated:{webpack:()=>[2788]},ssr:!1,loading:()=>(0,t.jsx)("p",{children:"Loading bike inventory..."})}),G=(0,n.default)(()=>Promise.all([r.e(405),r.e(871)]).then(r.bind(r,871)),{loadableGenerated:{webpack:()=>[871]},ssr:!1,loading:()=>(0,t.jsx)("p",{children:"Loading CSV importer..."})}),L=(0,n.default)(()=>Promise.all([r.e(410),r.e(602)]).then(r.bind(r,1590)),{loadableGenerated:{webpack:()=>[1590]},ssr:!1});function I(){let[e,s]=(0,i.useState)(null),[r,n]=(0,i.useState)(0),[l,a]=(0,i.useState)(!0),[o,h]=(0,i.useState)(!1),[u,m]=(0,i.useState)(!1),[g,b]=(0,i.useState)(!1),{user:f,userData:v,loading:y}=(0,j.A)(),I=(null==v?void 0:v.hasAccess)||(null==v?void 0:v.isAdmin),F=null==v?void 0:v.isAdmin;return((0,S.usePathname)(),(0,i.useEffect)(()=>{let e=e=>{var r,t;console.error("Global error:",e.error),((null==(r=e.error)?void 0:r.toString().includes("Firebase"))||(null==(t=e.error)?void 0:t.toString().includes("Firestore")))&&(s(e.error),e.preventDefault())};return window.addEventListener("error",e),()=>window.removeEventListener("error",e)},[]),y)?(0,t.jsx)("main",{className:"flex min-h-screen flex-col p-6",children:(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("div",{className:"flex items-center mb-4",children:(0,t.jsxs)("div",{className:"flex items-center flex-grow",children:[(0,t.jsx)("img",{src:(0,E.O)("/bixy-logo.svg"),alt:"Bixy Logo",width:80,height:64,style:{objectFit:"contain"}}),(0,t.jsx)("h1",{className:"text-3xl font-bold ml-4",children:"Bixy Stock Management"})]})}),(0,t.jsx)("div",{className:"flex justify-center items-center h-[calc(100vh-150px)]",children:(0,t.jsx)("p",{children:"Loading..."})})]})}):e?(0,t.jsx)("main",{className:"flex min-h-screen flex-col p-6",children:(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("div",{className:"flex items-center mb-4",children:(0,t.jsxs)("div",{className:"flex items-center flex-grow",children:[(0,t.jsx)("img",{src:(0,E.O)("/bixy-logo.svg"),alt:"Bixy Logo",width:80,height:64,style:{objectFit:"contain"}}),(0,t.jsx)("h1",{className:"text-3xl font-bold ml-4",children:"Bixy Stock Management"}),(0,t.jsx)("div",{className:"ml-2",children:(0,t.jsx)(c,{})}),(0,t.jsx)("div",{className:"ml-auto",children:(0,t.jsx)(p,{})})]})}),(0,t.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[(0,t.jsx)("p",{className:"font-bold",children:"Error connecting to database"}),(0,t.jsx)("p",{children:e.message}),(0,t.jsx)("p",{className:"mt-2",children:"Please check your Firebase configuration and make sure you have the correct permissions."})]})]})}):f&&(!f||I)?(0,t.jsxs)("main",{className:"flex min-h-screen flex-col p-6",children:[(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("div",{className:"flex items-center mb-4",children:(0,t.jsxs)("div",{className:"flex items-center flex-grow",children:[(0,t.jsx)("img",{src:(0,E.O)("/bixy-logo.svg"),alt:"Bixy Logo",width:80,height:64,style:{objectFit:"contain"}}),(0,t.jsx)("h1",{className:"text-3xl font-bold ml-4",children:"Bixy Stock Management"}),(0,t.jsx)("div",{className:"ml-2",children:(0,t.jsx)(c,{})}),(0,t.jsx)("div",{className:"ml-auto",children:(0,t.jsx)(p,{})})]})}),(0,t.jsx)("div",{className:"flex items-center mb-4",children:(0,t.jsxs)(d.A,{sx:{display:"flex",width:"100%",alignItems:"center",borderBottom:1,borderColor:"divider"},children:[(0,t.jsxs)(A.A,{value:r,onChange:(e,s)=>{n(s),0===s?(a(!0),h(!1)):(a(!1),h(!0))},"aria-label":"inventory tabs",sx:{flexGrow:1,"& .MuiTab-root":{color:"#555555","&.Mui-selected":{color:"#1976d2"}}},children:[(0,t.jsx)(N.A,{label:"View Inventory"}),(0,t.jsx)(N.A,{label:"Import from CSV"})]}),(0,t.jsx)(d.A,{sx:{ml:2,display:"flex",gap:1},children:F&&(0,t.jsx)(x.A,{variant:"outlined",color:"primary",onClick:()=>{b(!0)},startIcon:(0,t.jsx)(k.A,{}),children:"Users"})})]})}),(0,t.jsxs)("div",{children:[l&&(0,t.jsx)("div",{className:"h-[calc(100vh-200px)]",children:(0,t.jsx)(C,{openAddDialog:u,setOpenAddDialog:m})}),o&&(0,t.jsx)("div",{children:(0,t.jsx)(G,{})})]})]}),(0,t.jsx)(L,{open:g,onClose:()=>{b(!1)}})]}):(0,t.jsx)("main",{className:"flex min-h-screen flex-col p-6",children:(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("div",{className:"flex items-center mb-4",children:(0,t.jsxs)("div",{className:"flex items-center flex-grow",children:[(0,t.jsx)("img",{src:(0,E.O)("/bixy-logo.svg"),alt:"Bixy Logo",width:80,height:64,style:{objectFit:"contain"}}),(0,t.jsx)("h1",{className:"text-3xl font-bold ml-4",children:"Bixy Stock Management"}),(0,t.jsx)("div",{className:"ml-2",children:(0,t.jsx)(c,{})}),(0,t.jsx)("div",{className:"ml-auto",children:(0,t.jsx)(p,{})})]})}),f&&!I&&(0,t.jsx)(w,{})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,118,566,329,441,684,358],()=>s(1786)),_N_E=e.O()}]);