"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[398],{26398:(e,a,r)=>{r.r(a),r.d(a,{default:()=>D});var l=r(95155),t=r(12115),n=r(56278),i=r(54492),o=r(99927),s=r(54581),c=r(73731),m=r(27088),d=r(17348),u=r(16675),g=r(76380),h=r(47516),b=r(90835),p=r(52596),x=r(17472),A=r(75955),f=r(77856),y=r(55170),j=r(90870);function k(e){return(0,j.Ay)("MuiDialogActions",e)}(0,y.A)("MuiDialogActions",["root","spacing"]);let w=e=>{let{classes:a,disableSpacing:r}=e;return(0,x.A)({root:["root",!r&&"spacing"]},k,a)},C=(0,A.Ay)("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,a)=>{let{ownerState:r}=e;return[a.root,!r.disableSpacing&&a.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:e=>{let{ownerState:a}=e;return!a.disableSpacing},style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),v=t.forwardRef(function(e,a){let r=(0,f.b)({props:e,name:"MuiDialogActions"}),{className:t,disableSpacing:n=!1,...i}=r,o={...r,disableSpacing:n},s=w(o);return(0,l.jsx)(C,{className:(0,p.A)(s.root,t),ownerState:o,ref:a,...i})});var E=r(68534),M=r(69325),N=r(84792);let R={manufacturer:"Bulls",modelName:"",modelNumber:"",modelYear:new Date().getFullYear(),weight:0,frameMaterial:"",imageUrl:0,link:"",location:"",battery:"",color:"",size:"",category:"",isEbike:!1,pieces:1,priceRetail:0,priceAction:0,priceReseller:0,note:""},B=["MTB","Road","Gravel","City","Trekking","Kids","Other"],P=e=>(0,N.O)("/jpeg/".concat(e,".jpeg")),S=()=>(0,N.O)("/file.svg");function D(e){let{open:a,onClose:r,onSuccess:p,editBike:x}=e,[A,f]=(0,t.useState)(x||R),[y,j]=(0,t.useState)(!1),k=!!x;(0,t.useEffect)(()=>{f(x||R)},[x,a]);let w=e=>{let{name:a,value:r,type:l,checked:t}=e.target;f(e=>({...e,[a]:"checkbox"===l?t:"number"===l?Number(r):r}))},C=async()=>{try{k&&A.id?await (0,M.nP)(A.id,A):await (0,M.Jy)(A),p(),r()}catch(e){console.error("Error saving bike:",e)}},N=()=>{f(R),r()};return(0,l.jsxs)(n.A,{open:a,onClose:N,maxWidth:"md",fullWidth:!0,children:[(0,l.jsx)(i.A,{children:k?"Edit Bike":"Add New Bike"}),(0,l.jsx)(o.A,{children:(0,l.jsxs)(s.A,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:{xs:"calc(100% - 16px)",sm:"47%"}},display:"flex",flexWrap:"wrap",mt:1},noValidate:!0,autoComplete:"off",children:[(0,l.jsx)(c.A,{label:"Manufacturer",name:"manufacturer",value:A.manufacturer,onChange:w,disabled:!0}),(0,l.jsx)(c.A,{label:"Model Name",name:"modelName",value:A.modelName,onChange:w,required:!0}),(0,l.jsx)(c.A,{label:"Model Year",name:"modelYear",type:"number",value:A.modelYear,onChange:w,required:!0}),(0,l.jsx)(c.A,{label:"Weight (kg)",name:"weight",type:"number",value:A.weight,onChange:w}),(0,l.jsx)(c.A,{label:"Frame Material",name:"frameMaterial",value:A.frameMaterial,onChange:w}),(0,l.jsxs)(s.A,{sx:{m:1,width:{xs:"calc(100% - 16px)",sm:"97%"}},children:[(0,l.jsx)(c.A,{label:"Image Number",name:"imageUrl",type:"number",value:A.imageUrl,onChange:e=>{let{value:a}=e.target;f(e=>({...e,imageUrl:parseInt(a)||0}))},placeholder:"Enter image number",fullWidth:!0,helperText:"Enter the number of the JPEG file in the jpeg folder",InputProps:{endAdornment:A.imageUrl?(0,l.jsx)("a",{href:P(A.imageUrl),target:"_blank",rel:"noopener noreferrer",style:{marginLeft:"8px",color:"#1976d2",textDecoration:"none"},children:"View image"}):null}}),A.imageUrl>0&&(0,l.jsx)(s.A,{sx:{mt:1,display:"flex",justifyContent:"center",height:"100px"},children:(0,l.jsx)("img",{src:P(A.imageUrl),alt:"Bike preview",style:{maxHeight:"100%",maxWidth:"100%",objectFit:"contain"},onError:e=>{j(!0),e.target.src=S(),e.target.onerror=null},onLoad:()=>j(!1)})})]}),(0,l.jsx)(c.A,{label:"Location",name:"location",value:A.location,onChange:w}),(0,l.jsx)(c.A,{label:"Battery",name:"battery",value:A.battery,onChange:w}),(0,l.jsx)(c.A,{label:"Color",name:"color",value:A.color,onChange:w}),(0,l.jsx)(c.A,{label:"Size",name:"size",value:A.size,onChange:w}),(0,l.jsxs)(m.A,{sx:{m:1,width:{xs:"calc(100% - 16px)",sm:"47%"}},children:[(0,l.jsx)(d.A,{id:"category-label",children:"Category"}),(0,l.jsx)(u.A,{labelId:"category-label",id:"category",name:"category",value:A.category,label:"Category",onChange:e=>{let{name:a,value:r}=e.target;a&&f(e=>({...e,[a]:r}))},children:B.map(e=>(0,l.jsx)(g.A,{value:e,children:e},e))})]}),(0,l.jsx)(h.A,{control:(0,l.jsx)(b.A,{checked:A.isEbike,onChange:w,name:"isEbike"}),label:"E-Bike",sx:{m:1,width:{xs:"calc(100% - 16px)",sm:"47%"}}}),(0,l.jsx)(c.A,{label:"Model Number",name:"modelNumber",value:A.modelNumber,onChange:w}),(0,l.jsx)(c.A,{label:"Product Link",name:"link",value:A.link,onChange:w}),(0,l.jsx)(c.A,{label:"Pieces",name:"pieces",type:"number",value:A.pieces,onChange:w}),(0,l.jsx)(c.A,{label:"Retail Price",name:"priceRetail",type:"number",value:A.priceRetail,onChange:w}),(0,l.jsx)(c.A,{label:"Action Price",name:"priceAction",type:"number",value:A.priceAction,onChange:w}),(0,l.jsx)(c.A,{label:"Reseller Price",name:"priceReseller",type:"number",value:A.priceReseller,onChange:w}),(0,l.jsx)(c.A,{label:"Notes",name:"note",value:A.note,onChange:w,multiline:!0,rows:4,sx:{m:1,width:{xs:"calc(100% - 16px)",sm:"97%"}}})]})}),(0,l.jsxs)(v,{children:[(0,l.jsx)(E.A,{onClick:N,children:"Cancel"}),(0,l.jsx)(E.A,{onClick:C,variant:"contained",children:"Save"})]})]})}},69325:(e,a,r)=>{r.d(a,{JD:()=>o,Jy:()=>s,l$:()=>m,nP:()=>c});var l=r(35317),t=r(810);let n="bikes",i=(0,l.collection)(t.db,n),o=async()=>{try{let e=(await (0,l.getDocs)(i)).docs.map(e=>{let a=e.data();return console.log("Raw bike data from Firebase:",a),{id:e.id,...a}});return console.log("Processed bikes:",e),e}catch(e){if(console.error("Error fetching bikes:",e),e instanceof Error&&e.message.includes("Missing or insufficient permissions")){console.log("Attempting to create collection...");try{return await (0,l.gS)(i,{manufacturer:"Bulls",modelName:"Test Bike",modelNumber:"TB-2024",modelYear:2024,weight:15,frameMaterial:"Aluminum",imageUrl:0,link:"",location:"Store",battery:"Test 500Wh",color:"Black",size:"M",category:"MTB",isEbike:!0,pieces:1,priceRetail:59990,priceAction:54990,priceReseller:49990,note:"Test bike"}),(await (0,l.getDocs)(i)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw console.error("Could not create collection:",e),e}}throw e}},s=async e=>{try{return(await (0,l.gS)(i,e)).id}catch(e){throw console.error("Error adding bike:",e),e}},c=async(e,a)=>{try{let r=(0,l.H9)(t.db,n,e);await (0,l.mZ)(r,{...a})}catch(e){throw console.error("Error updating bike:",e),e}},m=async e=>{try{let a=(0,l.H9)(t.db,n,e);await (0,l.kd)(a)}catch(e){throw console.error("Error deleting bike:",e),e}}}}]);